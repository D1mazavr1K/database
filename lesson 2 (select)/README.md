# Задание

Написать запросы:

1. Вывести имена и фамилии студентов + названия хобби, которыми они сейчас занимаются
2. Вывести фамилию, имя, дату рождения, название хобби и длительность в месяцах, для всех завершенных хобби
3. Вывести фамилию, имя, зачетку, дату рождения студентов, которым исполнилось N полных лет на текущую дату
4. Найти название, риск, длительность в месяцах самого продолжительного хобби из действующих, указав номер зачетки студента.
5. Найти все хобби, которыми увлекаются студенты, имеющие максимальный балл.
6. Найти все действующие хобби, которыми увлекаются троечники 2-го курса.
7. Найти имена и фамилии студентов (+название хобби), которые начали заниматься каким-нибудь хобби (указать hobby_id в `WHERE Clause`) в веденном диапазоне дат
8. Вывести номера групп (без повторений), в которых есть студенты без активного хобби
9. Вывести номера групп (без повторений) первого курса, используя CAST (преобразовать номер в строку, и проверить что строка начинается с `1`)
10. Вывести номера групп (без повторений), в которых есть отличники, занимающиеся каким-либо хобби больше 1 года


# DML

DML - Data Manipulation Language (язык манипулирования данными)

Язык DML содержит следующие конструкции:
  -  SELECT – выборка данных
  -  INSERT – вставка новых данных
  -  UPDATE – обновление данных
  -  DELETE – удаление данных

## Оператор выбора SELECT

Все запросы на получение практически любого количества данных из одной или нескольких таблиц выполняются с помощью единственного предложения SELECT. Синтаксис оператора SELECT имеет следующий вид:

```sql
SELECT [ALL | DISTINCT] <список полей> | *
FROM <список таблиц>
[WHERE <условие фильтрации строк>]
[GROUP BY <условия группировки строк>]
[HAVING <условие фильтрации групп>]
[ORDER BY <условие сортировки результата запроса>]
```

Обязательными среди всех указанных параметров оператора SELECT являются параметры SELECT и FROM. Результатом выполнения оператора SELECT является набор данных (временная таблица), который затем либо передается пользователю, запросившему данные, либо используется как источник данных для другого оператора SELECT в качестве подзапроса.

### Выборка всей информации из таблицы

```sql
SELECT список_всех_полей_таблицы | *
FROM имя_таблицы;
```

Данная форма оператора SELECT используется, когда не нужно выполнять ни горизонтальную, ни вертикальную фильтрации. Символ «\*» заменяет необходимость указания всех полей таблицы. Например:

```sql
SELECT *
FROM student;
```

### Псевдоним

Псевдонимы (alias) удобно использовать для более удобного доступа к таблицам в запросе, а также для переименования атрибутов.

Если запрос на одну таблицу, то понятно, что псевдонимами можно принебречь, но лучше привыкать так всегда.

Примеры:

Без использования псевдонима

```sql
Select name, surname
From student
```

С использованием псевдонима таблицы

```sql
Select s.name, s.surname
From student s
```

С использованием псевдонима атрибутов

```sql
Select s.name as students_name, s.surname as n
From student s
```

Код выше сработает и без `as`, но для удобства лучше его использовать.

### Вертикальная фильтрация с указанием порядка вывода атрибутов

```sql
SELECT поле1[, поле2, …] FROM имя_таблицы;
```

В результирующий набор записей попадут данные только из указанных полей таблицы, причем в том же самом порядке, в каком они указаны в операторе SELECT. Например:

-- вывод неполной информации о студентах

```sql
SELECT id,
       name
FROM student;
```

### Исключение дубликатов

При использовании в операторе SELECT вертикальной фильтрации строк таблицы может сложиться ситуация, когда набор записей будет включать дубликаты – записи, значения полей которых полностью совпадают. Для исключения дубликатов из результирующего набора записей используют параметр DISTINCT, который указывают сразу после ключевого слова SELECT. Например:

-- вывод различных фамилий

```sql
SELECT DISTINCT surname
FROM student;
```

### Сортировка результирующего набора данных

Строки в таблицах базы данных изначально хранятся в том порядке, в каком их туда поместили. Для сортировки результирующего набора данных используется параметр ORDER BY оператора SELECT. Например:

```sql
SELECT *
FROM student
ORDER BY surname,
         name;
```

Если после параметра ORDER BY указано более одного поля, сортировка сначала осуществляется по первому полю, потом, в случае наличия одинаковых значений, по второму и т.д. В приведенном примере результирующий набор данных сначала будет отсортирован по значениям поля surname, и в том случае, если в каких-то строках фамилии некоторых студентов совпадут, эти строки отдельно будут отсортированы по имени студента.

По умолчанию (неявно) сортировка всегда происходит по возрастанию. Но способ сортировки можно задать явно, указав после соответствующего поля параметр ASC или DESC для сортировки по возрастанию или убыванию соответственно. Например:

```sql
SELECT *
FROM student
ORDER BY surname,
         name DESC;
```

### Выборка с использованием параметра WHERE

Параметр WHERE служит для реализации реляционной операции горизонтальной фильтрации, то есть отбора кортежей, или строк, удовлетворяющих определенному условию. Условие может быть составлено с использованием следующих конструкций:

- операторы сравнения: =, < , > , <= , >= , <>
- булевы операторы: AND, OR, NOT
- оператор проверки на вхождение в множество: IN
- оператор проверки на вхождение в диапазон: BETWEEN
- оператор проверки удовлетворению шаблону (только для символьных полей): LIKE
- операторы сравнения с NULL: IS NULL, IS NOT NULL
- операторы сравнения с TRUE/FALSE: IS TRUE, IS NOT TRUE, IS FALSE, IS NOT FALSE
- агрегатные функции: COUNT, SUM, AVG, MAX, MIN


### Использование операторов сравнения

В параметре WHERE оператора SELECT для отбора нужных строк таблицы можно использовать операторы сравнения = (равно), <> (не равно), < (меньше), <= (меньше или равно), > (больше), > = (больше или равно), которые могут предваряться оператором NOT, создавая, например, отношения «не меньше» и «не больше».

```sql
SELECT name
FROM hobby
WHERE risk <=5;
```

-- то же самое с применением оператора NOT

```sql
SELECT name
FROM hobby
WHERE NOT risk >5;
```

Возможность использования нескольких условий, соединенных логическими операторами AND, OR, AND NOT и OR NOT, позволяет осуществить более детальный отбор строк.

### Использование BETWEEN

С помощью оператора BETWEEN можно отобрать строки, в которых значение какого-либо столбца находятся в заданном диапазоне.

При помощи сочетания операторов NOT и BETWEEN можно отобрать строки, в которых значение какого-либо столбца не находится в заданном диапазоне. Например:

```sql
SELECT name
FROM hobby
WHERE risk NOT BETWEEN 5 AND 8;
```

Использование оператора BETWEEN возможно не только по отношению к полям числового типа, он применим также к полям строкового типа и датам.

### Использование IN

Оператор IN используется для проверки вхождения значения какого-либо столбца в множество. Например:

```sql
SELECT n_group
FROM student
WHERE n_group IN (11,
               12,
               13);
```

Рассмотренная форма IN является в действительности просто краткой записью последовательности отдельных сравнений, соединенных операторами OR.

В сочетании с оператором IN можно также использовать NOT для отбора строк, в которых значение какого-либо столбца наоборот не входит в множество. Например:

```sql
SELECT n_group
FROM student
WHERE n_group NOT IN (11,
                   12,
                   13);
```

### Использование LIKE

Оператор LIKE используется для отбора строк, в которых значение какого-либо удовлетворяет определенному шаблону. Данный оператор применяется только к символьным полям. Обычная форма *имя*столбца* LIKE *текстовая*константа* для столбца символьного типа позволяет отыскать все значения указанного столбца, соответствующие шаблону, заданному *текстовой*константой\_. Символы этой константы интерпретируются следующим образом:

- символ \_ (подчеркивание) – заменяет любой одиночный символ;
- символ % (процент) – заменяет любую последовательность из любого количества символов, в том числе нулевого;
- все другие символы означают просто сами себя.

Примеры: отбор информации о студентах, фамилии которых начинаются с заглавной буквы «С» и заканчивающихся на «в»

```sql
SELECT *
FROM student
WHERE surname LIKE 'С%ов';
```

### Многотабличные запросы

В реальности чаще используются выборки из нескольких таблиц, при этом есть несколько видов объдинения таблиц, в простейшем виде многотабличный запрос выглядит следующим образом:

```sql
select поля_таблиц
from таблица_1, таблица_2 [, ... таблица_n]
```

При написании многотабличного запроса необходимо указать какими атрибутами связаны между собой таблицы, сделать это можно в блоке WHERE

Пример: вывести список студентов и хобби, которыми они сейчасзанимаются

```sql
select s.nz_id, s.name, s.surname, h.name, 
from students s, students_hobby sh, hobby h
where s.nz_id = sh.nz_id AND sh.h_id = h.id AND sh.end_date is null
```

В данном случае мы вывели 
Попробуйте выполнить этот запрос не указав в блоке where связи между таблицами и посмотрите что получится (:

```sql
select *
from students s, students_hobby sh, hobby h
where sh.end_date is null
```


